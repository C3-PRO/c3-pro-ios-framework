Consenting
==========

A FHIR `Contract` resource constitutes a consent document that can be rendered using a `ORKTaskViewController` view controller.

> Currently only signing a contract is supported.


Signing
-------

A signed `Contract` resource can be generated by providing a Patient resource.
Using the `DeIdentifier` and `Geocoder` included in this framework, a de-identified Patient resource will be created alongside the Contract.

```swift
let server = <# SMART client #>.server
consentController = ConsentController()       // ivar on e.g. the App Delegate
consentController!.deIdentifyAndSignConsentWithPatient(patient, date: NSDate()) { contract, patient, error in
    patient._server = server
    patient.update() { error in     // cannot use `create` as an ID was assigned
        if let error = error {
            println("Error creating patient: \(error)")
        }
        else {
            if let observations = observations {
                for observation in observations {
                    observation.create(server) { error in
                        if let error = error {
                            println("Error creating observation: \(error)")
                        }
                    }
                }
            }
            contract.create(server) { error in
                if let error = error {
                    println("Error creating contract: \(error)")
                }
            }
        }
    }
}
```
